\doxysection{simulation\+\_\+core.\+c File Reference}
\hypertarget{simulation__core_8c}{}\label{simulation__core_8c}\index{simulation\_core.c@{simulation\_core.c}}
{\ttfamily \#include "{}simulation\+\_\+core.\+h"{}}\newline
{\ttfamily \#include "{}comp\+\_\+gen\+\_\+header.\+h"{}}\newline
{\ttfamily \#include "{}code\+\_\+handling.\+h"{}}\newline
{\ttfamily \#include "{}random\+\_\+numb\+\_\+gen.\+h"{}}\newline
{\ttfamily \#include "{}sim\+\_\+config.\+h"{}}\newline
{\ttfamily \#include "{}array\+\_\+utils.\+h"{}}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+rng.\+h$>$}\newline
Include dependency graph for simulation\+\_\+core.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{simulation__core_8c__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{simulation__core_8c_a1dfaa9c051bf45052ad83d6ced5a0a51}{SIM\+\_\+alloc\+\_\+ensemble\+\_\+state}} ()
\item 
void \mbox{\hyperlink{simulation__core_8c_ae87b1c4014ef0462dd2bcb306aa7e879}{SIM\+\_\+init\+\_\+positions}} (int setn\+\_\+per\+\_\+task)
\item 
void \mbox{\hyperlink{simulation__core_8c_a5c56c9137f9814671a0c4f894da0b93f}{SIM\+\_\+read\+\_\+in\+\_\+positions}} (int setn\+\_\+per\+\_\+task)
\item 
void \mbox{\hyperlink{simulation__core_8c_ae701731a09ec10367818e56633138dc3}{SIM\+\_\+init\+\_\+interactions}} (int setn\+\_\+per\+\_\+task)
\item 
double \mbox{\hyperlink{simulation__core_8c_abc46eb023973ba0aa12ba489bebfeff3}{reset\+\_\+pos\+\_\+time}} (int setn\+\_\+per\+\_\+task, long int \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}posshift, long int \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}negshift)
\item 
void \mbox{\hyperlink{simulation__core_8c_a322e5c1264b1b33550d3fdb541b6b18a}{adapt\+\_\+posshifts}} (int shiftind, int i, int j, long int \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}posshift, long int \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}negshift)
\item 
int \mbox{\hyperlink{simulation__core_8c_a0220ef45b4831df2ea84842919213d36}{update\+\_\+equcounter}} (double tran\+\_\+quant, double tran\+\_\+quanto, double accurarcy, int equcounter)
\item 
double \mbox{\hyperlink{simulation__core_8c_af8bc1c3b7c69d9e2bc57a18b9ccf4feb}{perform\+\_\+sim\+\_\+step}} (double old\+\_\+pos, double force\+\_\+ext\+\_\+dt, double force\+\_\+int\+\_\+dt, double sqrt\+\_\+flucts)
\item 
bool \mbox{\hyperlink{simulation__core_8c_a12ab8b349dcb2d7a2e9ef4899316aad0}{check\+\_\+pos\+\_\+validity}} (double x, double y, double yo)
\item 
void \mbox{\hyperlink{simulation__core_8c_a6feb1df0d46919c846a8f7d0f67e67b1}{update\+\_\+ensemble\+\_\+state}} (int j, int kset, double x, double y, double \mbox{\hyperlink{int__hardspheres_8c_ab25837e3f07407587bd3c8c278af97a9}{fintx}}, double \mbox{\hyperlink{int__hardspheres_8c_a0d88eaf8a8ecf4a72e848102e3761ca5}{finty}})
\item 
bool \mbox{\hyperlink{simulation__core_8c_ac7f2668488554db8023b897eb870bfd5}{calculate\+\_\+inter\+\_\+particle\+\_\+forces}} (int j, int kset, double x, double y, double \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{int__hardspheres_8c_ab25837e3f07407587bd3c8c278af97a9}{fintx}}, double \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{int__hardspheres_8c_a0d88eaf8a8ecf4a72e848102e3761ca5}{finty}})
\item 
void \mbox{\hyperlink{simulation__core_8c_af2bf522eb75fc8a2af71c8af3d98acfe}{shift\+\_\+pos\+\_\+for\+\_\+periodic\+\_\+bc}} (double \texorpdfstring{$\ast$}{*}x, int \texorpdfstring{$\ast$}{*}shiftind)
\item 
void \mbox{\hyperlink{simulation__core_8c_a5eed7d75099cbfca79c8169581fc6f0b}{SIM\+\_\+simulation\+\_\+core}} (int setn\+\_\+per\+\_\+task, int taskid)
\item 
void \mbox{\hyperlink{simulation__core_8c_a55ec47b209b66d0e76a34c77f8ef5ba6}{SIM\+\_\+copycode}} ()
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{structT__EnsembleState}{T\+\_\+\+Ensemble\+State}} \mbox{\hyperlink{simulation__core_8c_abc57728ff92d7a5800163368f7c9d43b}{Ensemble\+State}}
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{simulation__core_8c_a322e5c1264b1b33550d3fdb541b6b18a}\label{simulation__core_8c_a322e5c1264b1b33550d3fdb541b6b18a} 
\index{simulation\_core.c@{simulation\_core.c}!adapt\_posshifts@{adapt\_posshifts}}
\index{adapt\_posshifts@{adapt\_posshifts}!simulation\_core.c@{simulation\_core.c}}
\doxysubsubsection{\texorpdfstring{adapt\_posshifts()}{adapt\_posshifts()}}
{\footnotesize\ttfamily void adapt\+\_\+posshifts (\begin{DoxyParamCaption}\item[{int}]{shiftind,  }\item[{int}]{i,  }\item[{int}]{j,  }\item[{long int \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{posshift,  }\item[{long int \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{negshift }\end{DoxyParamCaption})}

Function to update shifts which are monitored to calculate absolute position in x-\/direction from simulation with cyclic boundary conditions\Hypertarget{simulation__core_8c_ac7f2668488554db8023b897eb870bfd5}\label{simulation__core_8c_ac7f2668488554db8023b897eb870bfd5} 
\index{simulation\_core.c@{simulation\_core.c}!calculate\_inter\_particle\_forces@{calculate\_inter\_particle\_forces}}
\index{calculate\_inter\_particle\_forces@{calculate\_inter\_particle\_forces}!simulation\_core.c@{simulation\_core.c}}
\doxysubsubsection{\texorpdfstring{calculate\_inter\_particle\_forces()}{calculate\_inter\_particle\_forces()}}
{\footnotesize\ttfamily bool calculate\+\_\+inter\+\_\+particle\+\_\+forces (\begin{DoxyParamCaption}\item[{int}]{j,  }\item[{int}]{kset,  }\item[{double}]{x,  }\item[{double}]{y,  }\item[{double \texorpdfstring{$\ast$}{*}}]{fintx,  }\item[{double \texorpdfstring{$\ast$}{*}}]{finty }\end{DoxyParamCaption})}

\Hypertarget{simulation__core_8c_a12ab8b349dcb2d7a2e9ef4899316aad0}\label{simulation__core_8c_a12ab8b349dcb2d7a2e9ef4899316aad0} 
\index{simulation\_core.c@{simulation\_core.c}!check\_pos\_validity@{check\_pos\_validity}}
\index{check\_pos\_validity@{check\_pos\_validity}!simulation\_core.c@{simulation\_core.c}}
\doxysubsubsection{\texorpdfstring{check\_pos\_validity()}{check\_pos\_validity()}}
{\footnotesize\ttfamily bool check\+\_\+pos\+\_\+validity (\begin{DoxyParamCaption}\item[{double}]{x,  }\item[{double}]{y,  }\item[{double}]{yo }\end{DoxyParamCaption})}

\Hypertarget{simulation__core_8c_af8bc1c3b7c69d9e2bc57a18b9ccf4feb}\label{simulation__core_8c_af8bc1c3b7c69d9e2bc57a18b9ccf4feb} 
\index{simulation\_core.c@{simulation\_core.c}!perform\_sim\_step@{perform\_sim\_step}}
\index{perform\_sim\_step@{perform\_sim\_step}!simulation\_core.c@{simulation\_core.c}}
\doxysubsubsection{\texorpdfstring{perform\_sim\_step()}{perform\_sim\_step()}}
{\footnotesize\ttfamily double perform\+\_\+sim\+\_\+step (\begin{DoxyParamCaption}\item[{double}]{old\+\_\+pos,  }\item[{double}]{force\+\_\+ext\+\_\+dt,  }\item[{double}]{force\+\_\+int\+\_\+dt,  }\item[{double}]{sqrt\+\_\+flucts }\end{DoxyParamCaption})}

\Hypertarget{simulation__core_8c_abc46eb023973ba0aa12ba489bebfeff3}\label{simulation__core_8c_abc46eb023973ba0aa12ba489bebfeff3} 
\index{simulation\_core.c@{simulation\_core.c}!reset\_pos\_time@{reset\_pos\_time}}
\index{reset\_pos\_time@{reset\_pos\_time}!simulation\_core.c@{simulation\_core.c}}
\doxysubsubsection{\texorpdfstring{reset\_pos\_time()}{reset\_pos\_time()}}
{\footnotesize\ttfamily double reset\+\_\+pos\+\_\+time (\begin{DoxyParamCaption}\item[{int}]{setn\+\_\+per\+\_\+task,  }\item[{long int \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{posshift,  }\item[{long int \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{negshift }\end{DoxyParamCaption})}

Function to reset the simulated system time t and the positions to originate values in order to skip transient effects from start of simulation.\Hypertarget{simulation__core_8c_af2bf522eb75fc8a2af71c8af3d98acfe}\label{simulation__core_8c_af2bf522eb75fc8a2af71c8af3d98acfe} 
\index{simulation\_core.c@{simulation\_core.c}!shift\_pos\_for\_periodic\_bc@{shift\_pos\_for\_periodic\_bc}}
\index{shift\_pos\_for\_periodic\_bc@{shift\_pos\_for\_periodic\_bc}!simulation\_core.c@{simulation\_core.c}}
\doxysubsubsection{\texorpdfstring{shift\_pos\_for\_periodic\_bc()}{shift\_pos\_for\_periodic\_bc()}}
{\footnotesize\ttfamily void shift\+\_\+pos\+\_\+for\+\_\+periodic\+\_\+bc (\begin{DoxyParamCaption}\item[{double \texorpdfstring{$\ast$}{*}}]{x,  }\item[{int \texorpdfstring{$\ast$}{*}}]{shiftind }\end{DoxyParamCaption})}

\Hypertarget{simulation__core_8c_a1dfaa9c051bf45052ad83d6ced5a0a51}\label{simulation__core_8c_a1dfaa9c051bf45052ad83d6ced5a0a51} 
\index{simulation\_core.c@{simulation\_core.c}!SIM\_alloc\_ensemble\_state@{SIM\_alloc\_ensemble\_state}}
\index{SIM\_alloc\_ensemble\_state@{SIM\_alloc\_ensemble\_state}!simulation\_core.c@{simulation\_core.c}}
\doxysubsubsection{\texorpdfstring{SIM\_alloc\_ensemble\_state()}{SIM\_alloc\_ensemble\_state()}}
{\footnotesize\ttfamily void SIM\+\_\+alloc\+\_\+ensemble\+\_\+state (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

External functions \Hypertarget{simulation__core_8c_a55ec47b209b66d0e76a34c77f8ef5ba6}\label{simulation__core_8c_a55ec47b209b66d0e76a34c77f8ef5ba6} 
\index{simulation\_core.c@{simulation\_core.c}!SIM\_copycode@{SIM\_copycode}}
\index{SIM\_copycode@{SIM\_copycode}!simulation\_core.c@{simulation\_core.c}}
\doxysubsubsection{\texorpdfstring{SIM\_copycode()}{SIM\_copycode()}}
{\footnotesize\ttfamily void SIM\+\_\+copycode (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

\Hypertarget{simulation__core_8c_ae701731a09ec10367818e56633138dc3}\label{simulation__core_8c_ae701731a09ec10367818e56633138dc3} 
\index{simulation\_core.c@{simulation\_core.c}!SIM\_init\_interactions@{SIM\_init\_interactions}}
\index{SIM\_init\_interactions@{SIM\_init\_interactions}!simulation\_core.c@{simulation\_core.c}}
\doxysubsubsection{\texorpdfstring{SIM\_init\_interactions()}{SIM\_init\_interactions()}}
{\footnotesize\ttfamily void SIM\+\_\+init\+\_\+interactions (\begin{DoxyParamCaption}\item[{int}]{setn\+\_\+per\+\_\+task }\end{DoxyParamCaption})}

Function that calculates depending on the positions of the particles the initial particle-\/particle interaction force if such a force e.\+g. given by a Lennard-\/\+Jones interaction is given.\Hypertarget{simulation__core_8c_ae87b1c4014ef0462dd2bcb306aa7e879}\label{simulation__core_8c_ae87b1c4014ef0462dd2bcb306aa7e879} 
\index{simulation\_core.c@{simulation\_core.c}!SIM\_init\_positions@{SIM\_init\_positions}}
\index{SIM\_init\_positions@{SIM\_init\_positions}!simulation\_core.c@{simulation\_core.c}}
\doxysubsubsection{\texorpdfstring{SIM\_init\_positions()}{SIM\_init\_positions()}}
{\footnotesize\ttfamily void SIM\+\_\+init\+\_\+positions (\begin{DoxyParamCaption}\item[{int}]{setn\+\_\+per\+\_\+task }\end{DoxyParamCaption})}

function that initializes the particle positions. The particles are uniformly distributed over the whole period length L\+\_\+\+CONF in a strip of width Sim\+Params.\+initwidth or the width of the channel if it is smaller. For interacting particles with hard core radius R\+\_\+int, configurations which involve an overlap of two particles are rejected.\Hypertarget{simulation__core_8c_a5c56c9137f9814671a0c4f894da0b93f}\label{simulation__core_8c_a5c56c9137f9814671a0c4f894da0b93f} 
\index{simulation\_core.c@{simulation\_core.c}!SIM\_read\_in\_positions@{SIM\_read\_in\_positions}}
\index{SIM\_read\_in\_positions@{SIM\_read\_in\_positions}!simulation\_core.c@{simulation\_core.c}}
\doxysubsubsection{\texorpdfstring{SIM\_read\_in\_positions()}{SIM\_read\_in\_positions()}}
{\footnotesize\ttfamily void SIM\+\_\+read\+\_\+in\+\_\+positions (\begin{DoxyParamCaption}\item[{int}]{setn\+\_\+per\+\_\+task }\end{DoxyParamCaption})}

function that reads in positions from file. File has to be text file with two columns\+: x-\/coordinate is stored in first column, y-\/coordinate in second column.\Hypertarget{simulation__core_8c_a5eed7d75099cbfca79c8169581fc6f0b}\label{simulation__core_8c_a5eed7d75099cbfca79c8169581fc6f0b} 
\index{simulation\_core.c@{simulation\_core.c}!SIM\_simulation\_core@{SIM\_simulation\_core}}
\index{SIM\_simulation\_core@{SIM\_simulation\_core}!simulation\_core.c@{simulation\_core.c}}
\doxysubsubsection{\texorpdfstring{SIM\_simulation\_core()}{SIM\_simulation\_core()}}
{\footnotesize\ttfamily void SIM\+\_\+simulation\+\_\+core (\begin{DoxyParamCaption}\item[{int}]{setn\+\_\+per\+\_\+task,  }\item[{int}]{taskid }\end{DoxyParamCaption})}

\Hypertarget{simulation__core_8c_a6feb1df0d46919c846a8f7d0f67e67b1}\label{simulation__core_8c_a6feb1df0d46919c846a8f7d0f67e67b1} 
\index{simulation\_core.c@{simulation\_core.c}!update\_ensemble\_state@{update\_ensemble\_state}}
\index{update\_ensemble\_state@{update\_ensemble\_state}!simulation\_core.c@{simulation\_core.c}}
\doxysubsubsection{\texorpdfstring{update\_ensemble\_state()}{update\_ensemble\_state()}}
{\footnotesize\ttfamily void update\+\_\+ensemble\+\_\+state (\begin{DoxyParamCaption}\item[{int}]{j,  }\item[{int}]{kset,  }\item[{double}]{x,  }\item[{double}]{y,  }\item[{double}]{fintx,  }\item[{double}]{finty }\end{DoxyParamCaption})}

\Hypertarget{simulation__core_8c_a0220ef45b4831df2ea84842919213d36}\label{simulation__core_8c_a0220ef45b4831df2ea84842919213d36} 
\index{simulation\_core.c@{simulation\_core.c}!update\_equcounter@{update\_equcounter}}
\index{update\_equcounter@{update\_equcounter}!simulation\_core.c@{simulation\_core.c}}
\doxysubsubsection{\texorpdfstring{update\_equcounter()}{update\_equcounter()}}
{\footnotesize\ttfamily int update\+\_\+equcounter (\begin{DoxyParamCaption}\item[{double}]{tran\+\_\+quant,  }\item[{double}]{tran\+\_\+quanto,  }\item[{double}]{accurarcy,  }\item[{int}]{equcounter }\end{DoxyParamCaption})}

Function for the update of the counter that is used to monitore the equilibration of the system. A transport quantity tran\+\_\+quant is compared with a previous value. If the difference is below the ~\newline
 demanded accurarcy, the value of the counter is increased. If the difference is larger than twice the accurarcy the counter is decreased

\doxysubsection{Variable Documentation}
\Hypertarget{simulation__core_8c_abc57728ff92d7a5800163368f7c9d43b}\label{simulation__core_8c_abc57728ff92d7a5800163368f7c9d43b} 
\index{simulation\_core.c@{simulation\_core.c}!EnsembleState@{EnsembleState}}
\index{EnsembleState@{EnsembleState}!simulation\_core.c@{simulation\_core.c}}
\doxysubsubsection{\texorpdfstring{EnsembleState}{EnsembleState}}
{\footnotesize\ttfamily \mbox{\hyperlink{structT__EnsembleState}{T\+\_\+\+Ensemble\+State}} Ensemble\+State}

